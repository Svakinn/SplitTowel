(function(a){if(typeof bootstrap=="function")bootstrap("promise",a);else if(typeof exports=="object")module.exports=a();else if(typeof define=="function"&&define.amd)define(a);else if(typeof ses!="undefined"){if(!ses.ok())return;ses.makeQ=a}else Q=a()})(function(){function h(a){return function(){return g.apply(a,arguments)}}function q(a){return a===Object(a)}function r(a){return p(a)==="[object StopIteration]"||a instanceof s}function v(b,c){if(a&&c.stack&&typeof b=="object"&&b!==null&&b.stack&&b.stack.indexOf(u)===-1){var d=[];for(var e=c;!!e;e=e.source)e.stack&&d.unshift(e.stack);d.unshift(b.stack);var f=d.join("\n"+u+"\n");b.stack=w(f)}}function w(a){var b=a.split("\n"),c=[];for(var d=0;d<b.length;++d){var e=b[d];!z(e)&&!x(e)&&e&&c.push(e)}return c.join("\n")}function x(a){return a.indexOf("(module.js:")!==-1||a.indexOf("(node.js:")!==-1}function y(a){var b=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(b)return[b[1],Number(b[2])];var c=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a);if(c)return[c[1],Number(c[2])];var d=/.*@(.+):(\d+)$/.exec(a);if(d)return[d[1],Number(d[2])]}function z(a){var b=y(a);if(!b)return!1;var e=b[0],f=b[1];return e===d&&f>=c&&f<=bk}function A(){if(!a)return;try{throw new Error}catch(b){var c=b.stack.split("\n"),e=c[0].indexOf("@")>0?c[1]:c[2],f=y(e);if(!f)return;return d=f[0],f[1]}}function B(a,b,c){return function(){return typeof console!="undefined"&&typeof console.warn=="function"&&console.warn(b+" is deprecated, use "+c+" instead.",(new Error("")).stack),a.apply(a,arguments)}}function C(a){return J(a)?a:K(a)?Z(a):Y(a)}function D(){function k(a){d=a,g.source=a,j(b,function(b,c){f(function(){a.promiseDispatch.apply(a,c)})},void 0),b=void 0,c=void 0}var b=[],c=[],d,e=m(D.prototype),g=m(G.prototype);g.promiseDispatch=function(a,e,g){var h=i(arguments);b?(b.push(h),e==="when"&&g[1]&&c.push(g[1])):f(function(){d.promiseDispatch.apply(d,h)})},g.valueOf=B(function(){if(b)return g;var a=I(d);return J(a)&&(d=a),a},"valueOf","inspect"),g.inspect=function(){return d?d.inspect():{state:"pending"}};if(C.longStackSupport&&a)try{throw new Error}catch(h){g.stack=h.stack.substring(h.stack.indexOf("\n")+1)}return e.promise=g,e.resolve=function(a){if(d)return;k(C(a))},e.fulfill=function(a){if(d)return;k(Y(a))},e.reject=function(a){if(d)return;k(X(a))},e.notify=function(a){if(d)return;j(c,function(b,c){f(function(){c(a)})},void 0)},e}function E(a){if(typeof a!="function")throw new TypeError("resolver must be a function.");var b=D();try{a(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}return b.promise}function F(a){return E(function(b,c){for(var d=0,e=a.length;d<e;d++)C(a[d]).then(b,c)})}function G(a,b,c){b===void 0&&(b=function(a){return X(new Error("Promise does not support operation: "+a))}),c===void 0&&(c=function(){return{state:"unknown"}});var d=m(G.prototype);d.promiseDispatch=function(c,e,f){var g;try{a[e]?g=a[e].apply(d,f):g=b.call(d,e,f)}catch(h){g=X(h)}c&&c(g)},d.inspect=c;if(c){var e=c();e.state==="rejected"&&(d.exception=e.reason),d.valueOf=B(function(){var a=c();return a.state==="pending"||a.state==="rejected"?d:a.value})}return d}function H(a,b,c,d){return C(a).then(b,c,d)}function I(a){if(J(a)){var b=a.inspect();if(b.state==="fulfilled")return b.value}return a}function J(a){return q(a)&&typeof a.promiseDispatch=="function"&&typeof a.inspect=="function"}function K(a){return q(a)&&typeof a.then=="function"}function L(a){return J(a)&&a.inspect().state==="pending"}function M(a){return!J(a)||a.inspect().state==="fulfilled"}function N(a){return J(a)&&a.inspect().state==="rejected"}function S(){!Q&&typeof window!="undefined"&&!window.Touch&&window.console&&console.warn("[Q] Unhandled rejection reasons (should be empty):",O),Q=!0}function T(){for(var a=0;a<O.length;a++){var b=O[a];console.warn("Unhandled rejection reason:",b)}}function U(){O.length=0,P.length=0,Q=!1,R||(R=!0,typeof process!="undefined"&&process.on&&process.on("exit",T))}function V(a,b){if(!R)return;P.push(a),b&&typeof b.stack!="undefined"?O.push(b.stack):O.push("(no stack) "+b),S()}function W(a){if(!R)return;var b=k(P,a);b!==-1&&(P.splice(b,1),O.splice(b,1))}function X(a){var b=G({when:function(b){return b&&W(this),b?b(a):this}},function(){return this},function(){return{state:"rejected",reason:a}});return V(b,a),b}function Y(a){return G({when:function(){return a},get:function(b){return a[b]},set:function(b,c){a[b]=c},"delete":function(b){delete a[b]},post:function(b,c){return b===null||b===void 0?a.apply(void 0,c):a[b].apply(a,c)},apply:function(b,c){return a.apply(b,c)},keys:function(){return o(a)}},void 0,function(){return{state:"fulfilled",value:a}})}function Z(a){var b=D();return f(function(){try{a.then(b.resolve,b.reject,b.notify)}catch(c){b.reject(c)}}),b.promise}function $(a){return G({isDef:function(){}},function b(b,c){return be(a,b,c)},function(){return C(a).inspect()})}function _(a,b,c){return C(a).spread(b,c)}function ba(a){return function(){function b(a,b){var f;if(t){try{f=c[a](b)}catch(g){return X(g)}return f.done?f.value:H(f.value,d,e)}try{f=c[a](b)}catch(g){return r(g)?g.value:X(g)}return H(f,d,e)}var c=a.apply(this,arguments),d=b.bind(b,"next"),e=b.bind(b,"throw");return d()}}function bb(a){C.done(C.async(a)())}function bc(a){throw new s(a)}function bd(a){return function(){return _([this,bf(arguments)],function(b,c){return a.apply(b,c)})}}function be(a,b,c){return C(a).dispatch(b,c)}function bf(a){return H(a,function(a){var b=0,c=D();return j(a,function(d,e,f){var g;J(e)&&(g=e.inspect()).state==="fulfilled"?a[f]=g.value:(++b,H(e,function(d){a[f]=d,--b===0&&c.resolve(a)},c.reject,function(a){c.notify({index:f,value:a})}))},void 0),b===0&&c.resolve(a),c.promise})}function bg(a){return H(a,function(a){return a=l(a,C),H(bf(l(a,function(a){return H(a,e,e)})),function(){return a})})}function bh(a){return C(a).allSettled()}function bi(a,b){return C(a).then(void 0,void 0,b)}function bj(a,b){return C(a).nodeify(b)}"use strict";var a=!1;try{throw new Error}catch(b){a=!!b.stack}var c=A(),d,e=function(){},f=function(){function g(){while(a.next){a=a.next;var b=a.task;a.task=void 0;var d=a.domain;d&&(a.domain=void 0,d.enter());try{b()}catch(f){if(e)throw d&&d.exit(),setTimeout(g,0),d&&d.enter(),f;setTimeout(function(){throw f},0)}d&&d.exit()}c=!1}var a={task:void 0,next:null},b=a,c=!1,d=void 0,e=!1;f=function(a){b=b.next={task:a,domain:e&&process.domain,next:null},c||(c=!0,d())};if(typeof process!="undefined"&&process.nextTick)e=!0,d=function(){process.nextTick(g)};else if(typeof setImmediate=="function")typeof window!="undefined"?d=setImmediate.bind(window,g):d=function(){setImmediate(g)};else if(typeof MessageChannel!="undefined"){var h=new MessageChannel;h.port1.onmessage=function(){d=i,h.port1.onmessage=g,g()};var i=function(){h.port2.postMessage(0)};d=function(){setTimeout(g,0),i()}}else d=function(){setTimeout(g,0)};return f}(),g=Function.call,i=h(Array.prototype.slice),j=h(Array.prototype.reduce||function(a,b){var c=0,d=this.length;if(arguments.length===1)do{if(c in this){b=this[c++];break}if(++c>=d)throw new TypeError}while(1);for(;c<d;c++)c in this&&(b=a(b,this[c],c));return b}),k=h(Array.prototype.indexOf||function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),l=h(Array.prototype.map||function(a,b){var c=this,d=[];return j(c,function(e,f,g){d.push(a.call(b,f,g,c))},void 0),d}),m=Object.create||function(a){function b(){}return b.prototype=a,new b},n=h(Object.prototype.hasOwnProperty),o=Object.keys||function(a){var b=[];for(var c in a)n(a,c)&&b.push(c);return b},p=h(Object.prototype.toString),s;typeof ReturnValue!="undefined"?s=ReturnValue:s=function(a){this.value=a};var t;try{new Function("(function* (){ yield 1; })"),t=!0}catch(b){t=!1}var u="From previous event:";C.resolve=C,C.nextTick=f,C.longStackSupport=!1,C.defer=D,D.prototype.makeNodeResolver=function(){var a=this;return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(i(arguments,1)):a.resolve(c)}},C.promise=E,C.passByCopy=function(a){return a},G.prototype.passByCopy=function(){return this},C.join=function(a,b){return C(a).join(b)},G.prototype.join=function(a){return C([this,a]).spread(function(a,b){if(a===b)return a;throw new Error("Can't join: not the same: "+a+" "+b)})},C.race=F,G.prototype.race=function(){return this.then(C.race)},C.makePromise=G,G.prototype.toString=function(){return"[object Promise]"},G.prototype.then=function(a,b,c){function h(b){try{return typeof a=="function"?a(b):b}catch(c){return X(c)}}function i(a){if(typeof b=="function"){v(a,d);try{return b(a)}catch(c){return X(c)}}return X(a)}function j(a){return typeof c=="function"?c(a):a}var d=this,e=D(),g=!1;return f(function(){d.promiseDispatch(function(a){if(g)return;g=!0,e.resolve(h(a))},"when",[function(a){if(g)return;g=!0,e.resolve(i(a))}])}),d.promiseDispatch(void 0,"when",[void 0,function(a){var b,c=!1;try{b=j(a)}catch(d){c=!0;if(C.onerror)C.onerror(d);else throw d}c||e.notify(b)}]),e.promise},C.when=H,G.prototype.thenResolve=function(a){return this.then(function(){return a})},C.thenResolve=function(a,b){return C(a).thenResolve(b)},G.prototype.thenReject=function(a){return this.then(function(){throw a})},C.thenReject=function(a,b){return C(a).thenReject(b)},C.nearer=I,C.isPromise=J,C.isPromiseAlike=K,C.isPending=L,G.prototype.isPending=function(){return this.inspect().state==="pending"},C.isFulfilled=M,G.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"},C.isRejected=N,G.prototype.isRejected=function(){return this.inspect().state==="rejected"};var O=[],P=[],Q=!1,R=!0;C.resetUnhandledRejections=U,C.getUnhandledReasons=function(){return O.slice()},C.stopUnhandledRejectionTracking=function(){U(),typeof process!="undefined"&&process.on&&process.removeListener("exit",T),R=!1},U(),C.reject=X,C.fulfill=Y,C.master=$,C.spread=_,G.prototype.spread=function(a,b){return this.all().then(function(b){return a.apply(void 0,b)},b)},C.async=ba,C.spawn=bb,C["return"]=bc,C.promised=bd,C.dispatch=be,G.prototype.dispatch=function(a,b){var c=this,d=D();return f(function(){c.promiseDispatch(d.resolve,a,b)}),d.promise},C.get=function(a,b){return C(a).dispatch("get",[b])},G.prototype.get=function(a){return this.dispatch("get",[a])},C.set=function(a,b,c){return C(a).dispatch("set",[b,c])},G.prototype.set=function(a,b){return this.dispatch("set",[a,b])},C.del=C["delete"]=function(a,b){return C(a).dispatch("delete",[b])},G.prototype.del=G.prototype["delete"]=function(a){return this.dispatch("delete",[a])},C.mapply=C.post=function(a,b,c){return C(a).dispatch("post",[b,c])},G.prototype.mapply=G.prototype.post=function(a,b){return this.dispatch("post",[a,b])},C.send=C.mcall=C.invoke=function(a,b){return C(a).dispatch("post",[b,i(arguments,2)])},G.prototype.send=G.prototype.mcall=G.prototype.invoke=function(a){return this.dispatch("post",[a,i(arguments,1)])},C.fapply=function(a,b){return C(a).dispatch("apply",[void 0,b])},G.prototype.fapply=function(a){return this.dispatch("apply",[void 0,a])},C["try"]=C.fcall=function(a){return C(a).dispatch("apply",[void 0,i(arguments,1)])},G.prototype.fcall=function(){return this.dispatch("apply",[void 0,i(arguments)])},C.fbind=function(a){var b=C(a),c=i(arguments,1);return function(){return b.dispatch("apply",[this,c.concat(i(arguments))])}},G.prototype.fbind=function(){var a=this,b=i(arguments);return function(){return a.dispatch("apply",[this,b.concat(i(arguments))])}},C.keys=function(a){return C(a).dispatch("keys",[])},G.prototype.keys=function(){return this.dispatch("keys",[])},C.all=bf,G.prototype.all=function(){return bf(this)},C.allResolved=B(bg,"allResolved","allSettled"),G.prototype.allResolved=function(){return bg(this)},C.allSettled=bh,G.prototype.allSettled=function(){return this.then(function(a){return bf(l(a,function(a){function b(){return a.inspect()}return a=C(a),a.then(b,b)}))})},C.fail=C["catch"]=function(a,b){return C(a).then(void 0,b)},G.prototype.fail=G.prototype["catch"]=function(a){return this.then(void 0,a)},C.progress=bi,G.prototype.progress=function(a){return this.then(void 0,void 0,a)},C.fin=C["finally"]=function(a,b){return C(a)["finally"](b)},G.prototype.fin=G.prototype["finally"]=function(a){return a=C(a),this.then(function(b){return a.fcall().then(function(){return b})},function(b){return a.fcall().then(function(){throw b})})},C.done=function(a,b,c,d){return C(a).done(b,c,d)},G.prototype.done=function(a,b,c){var d=function(a){f(function(){v(a,e);if(C.onerror)C.onerror(a);else throw a})},e=a||b||c?this.then(a,b,c):this;typeof process=="object"&&process&&process.domain&&(d=process.domain.bind(d)),e.then(void 0,d)},C.timeout=function(a,b,c){return C(a).timeout(b,c)},G.prototype.timeout=function(a,b){var c=D(),d=setTimeout(function(){c.reject(new Error(b||"Timed out after "+a+" ms"))},a);return this.then(function(a){clearTimeout(d),c.resolve(a)},function(a){clearTimeout(d),c.reject(a)},c.notify),c.promise},C.delay=function(a,b){return b===void 0&&(b=a,a=void 0),C(a).delay(b)},G.prototype.delay=function(a){return this.then(function(b){var c=D();return setTimeout(function(){c.resolve(b)},a),c.promise})},C.nfapply=function(a,b){return C(a).nfapply(b)},G.prototype.nfapply=function(a){var b=D(),c=i(a);return c.push(b.makeNodeResolver()),this.fapply(c).fail(b.reject),b.promise},C.nfcall=function(a){var b=i(arguments,1);return C(a).nfapply(b)},G.prototype.nfcall=function(){var a=i(arguments),b=D();return a.push(b.makeNodeResolver()),this.fapply(a).fail(b.reject),b.promise},C.nfbind=C.denodeify=function(a){var b=i(arguments,1);return function(){var c=b.concat(i(arguments)),d=D();return c.push(d.makeNodeResolver()),C(a).fapply(c).fail(d.reject),d.promise}},G.prototype.nfbind=G.prototype.denodeify=function(){var a=i(arguments);return a.unshift(this),C.denodeify.apply(void 0,a)},C.nbind=function(a,b){var c=i(arguments,2);return function(){function f(){return a.apply(b,arguments)}var d=c.concat(i(arguments)),e=D();return d.push(e.makeNodeResolver()),C(f).fapply(d).fail(e.reject),e.promise}},G.prototype.nbind=function(){var a=i(arguments,0);return a.unshift(this),C.nbind.apply(void 0,a)},C.nmapply=C.npost=function(a,b,c){return C(a).npost(b,c)},G.prototype.nmapply=G.prototype.npost=function(a,b){var c=i(b||[]),d=D();return c.push(d.makeNodeResolver()),this.dispatch("post",[a,c]).fail(d.reject),d.promise},C.nsend=C.nmcall=C.ninvoke=function(a,b){var c=i(arguments,2),d=D();return c.push(d.makeNodeResolver()),C(a).dispatch("post",[b,c]).fail(d.reject),d.promise},G.prototype.nsend=G.prototype.nmcall=G.prototype.ninvoke=function(a){var b=i(arguments,1),c=D();return b.push(c.makeNodeResolver()),this.dispatch("post",[a,b]).fail(c.reject),c.promise},C.nodeify=bj,G.prototype.nodeify=function(a){if(a)this.then(function(b){f(function(){a(null,b)})},function(b){f(function(){a(b)})});else return this};var bk=A();return C})